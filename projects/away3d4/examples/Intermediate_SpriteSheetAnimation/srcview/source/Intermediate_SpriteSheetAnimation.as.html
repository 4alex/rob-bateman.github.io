<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Intermediate_SpriteSheetAnimation.as</title>
<link rel="stylesheet" type="text/css" href="../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptComment">/*

Sprite sheet animation example in Away3d

Demonstrates:

How to use the SpriteSheetAnimator.
- using SpriteSheetMaterial
- using the SpriteSheetHelper for generation of the sprite sheets sources stored in an external swf source.
- multiple animators

How to tween the camera in an endless movement

How to assign an enviroMethod

Code by Fabrice Closier
fabrice3d@gmail.com
http://www.closier.nl

This code is distributed under the MIT License

Copyright (c) The Away Foundation http://www.theawayfoundation.org

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the “Software”), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

*/</span>

<span class="ActionScriptpackage">package</span> <span class="ActionScriptBracket/Brace">{</span>

    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">animators</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SpriteSheetAnimationSet</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">animators</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SpriteSheetAnimator</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">containers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">entities</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">animators</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nodes</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SpriteSheetClipNode</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">loaders</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Loader3D</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">loaders</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parsers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AWD2Parser</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AssetEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LoaderEvent</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">library</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">assets</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AssetType</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lights</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">PointLight</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">loaders</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Loader3D</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">loaders</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">parsers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">AWD2Parser</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lightpickers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">StaticLightPicker</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textures</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BitmapTexture</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textures</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Texture2DBase</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textures</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BitmapCubeTexture</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">methods</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">EnvMapMethod</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">methods</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">FogMethod</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">textures</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BitmapCubeTexture</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">away3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">tools</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">helpers</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">SpriteSheetHelper</span>;

    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">caurina</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">transitions</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Tweener</span>;

    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">display</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">events</span><span class="ActionScriptOperator">.</span><span class="ActionScriptOperator">*</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Vector3D</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">net</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">URLRequest</span>;

    <span class="ActionScriptComment">// The tweener swc is provided in the 'libs' package
</span>
    <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">SWF</span><span class="ActionScriptBracket/Brace">(</span>=<span class="ActionScriptString">"#000000"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">frameRate</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"60"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">quality</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"LOW"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
    
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">Intermediate_SpriteSheetAnimation</span> <span class="ActionScriptReserved">extends</span> <span class="ActionScriptDefault_Text">Sprite</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptComment">//the swf file holding timeline animations
</span>        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span>=<span class="ActionScriptString">"/../embeds/spritesheets/digits.swf"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">mimeType</span><span class="ActionScriptOperator">=</span><span class="ActionScriptString">"application/octet-stream"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">SourceSWF</span> : <span class="ActionScriptDefault_Text">Class</span>;
        
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span>=<span class="ActionScriptString">"/../embeds/spritesheets/textures/back_CB0.jpg"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Back_CB0_Bitmap</span>:<span class="ActionScriptDefault_Text">Class</span>;
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span>=<span class="ActionScriptString">"/../embeds/spritesheets/textures/back_CB1.jpg"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Back_CB1_Bitmap</span>:<span class="ActionScriptDefault_Text">Class</span>;
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span>=<span class="ActionScriptString">"/../embeds/spritesheets/textures/back_CB2.jpg"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Back_CB2_Bitmap</span>:<span class="ActionScriptDefault_Text">Class</span>;
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span>=<span class="ActionScriptString">"/../embeds/spritesheets/textures/back_CB3.jpg"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Back_CB3_Bitmap</span>:<span class="ActionScriptDefault_Text">Class</span>;
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span>=<span class="ActionScriptString">"/../embeds/spritesheets/textures/back_CB4.jpg"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Back_CB4_Bitmap</span>:<span class="ActionScriptDefault_Text">Class</span>;
        <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptMetadata">Embed</span><span class="ActionScriptBracket/Brace">(</span>=<span class="ActionScriptString">"/../embeds/spritesheets/textures/back_CB5.jpg"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">Back_CB5_Bitmap</span>:<span class="ActionScriptDefault_Text">Class</span>;
        
        <span class="ActionScriptComment">//engine variables
</span>        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_view</span>:<span class="ActionScriptDefault_Text">View3D</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_loader</span>:<span class="ActionScriptDefault_Text">Loader3D</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_origin</span>:<span class="ActionScriptDefault_Text">Vector3D</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_staticLightPicker</span>:<span class="ActionScriptDefault_Text">StaticLightPicker</span>;

        <span class="ActionScriptComment">//demo variables
</span>        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_hoursDigits</span>:<span class="ActionScriptDefault_Text">SpriteSheetMaterial</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_minutesDigits</span>:<span class="ActionScriptDefault_Text">SpriteSheetMaterial</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_secondsDigits</span>:<span class="ActionScriptDefault_Text">SpriteSheetMaterial</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_delimiterMaterial</span>:<span class="ActionScriptDefault_Text">SpriteSheetMaterial</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_pulseMaterial</span>:<span class="ActionScriptDefault_Text">SpriteSheetMaterial</span>;

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_hoursAnimator</span>:<span class="ActionScriptDefault_Text">SpriteSheetAnimator</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_minutesAnimator</span>:<span class="ActionScriptDefault_Text">SpriteSheetAnimator</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_secondsAnimator</span>:<span class="ActionScriptDefault_Text">SpriteSheetAnimator</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_pulseAnimator</span>:<span class="ActionScriptDefault_Text">SpriteSheetAnimator</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_delimiterAnimator</span>:<span class="ActionScriptDefault_Text">SpriteSheetAnimator</span>;

        <span class="ActionScriptComment">//value set higher to force an update
</span>        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_lastHour</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 24;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_lastSecond</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 60;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_lastMinute</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 60;
         
        <span class="ActionScriptASDoc">/**
         * Constructor
         */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">Intermediate_SpriteSheetAnimation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">stage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">scaleMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">StageScaleMode</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">NO_SCALE</span>;
            <span class="ActionScriptDefault_Text">stage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">align</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">StageAlign</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TOP_LEFT</span>;
            
            <span class="ActionScriptComment">//view setup
</span>            <span class="ActionScriptDefault_Text">setUpView</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
 
            <span class="ActionScriptComment">//setup spritesheets and materials
</span>            <span class="ActionScriptDefault_Text">setUpSpriteSheets</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">//setting up some lights
</span>            <span class="ActionScriptDefault_Text">setUpLights</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
  
            <span class="ActionScriptDefault_Text">stage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RESIZE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onResize</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">onResize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setUpView</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//setup the view
</span>            <span class="ActionScriptDefault_Text">_view</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">View3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">antiAlias</span> <span class="ActionScriptOperator">=</span> 2;
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">backgroundColor</span> <span class="ActionScriptOperator">=</span> 0x10c14;

            <span class="ActionScriptComment">//setup the camera
</span>             <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">camera</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lens</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">near</span> <span class="ActionScriptOperator">=</span> 1000;
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">camera</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lens</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">far</span> <span class="ActionScriptOperator">=</span> 100000;
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">camera</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> -17850;
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">camera</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> 12390;
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">camera</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> -9322;

            <span class="ActionScriptComment">//saving the origin, as we look at it on enterframe
</span>            <span class="ActionScriptDefault_Text">_origin</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Vector3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * Lights setup
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setUpLights</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//Note that in 4.0, you could define the radius and falloff as Number.maxValue.
</span>            <span class="ActionScriptComment">//this is no longer the case in 4.1. As the default values are high enough, we do not need to declare them for light 1
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">plight1</span>:<span class="ActionScriptDefault_Text">PointLight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PointLight</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">plight1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> 5691;
            <span class="ActionScriptDefault_Text">plight1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> 10893;
            <span class="ActionScriptDefault_Text">plight1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">diffuse</span> <span class="ActionScriptOperator">=</span> 0.3;
            <span class="ActionScriptDefault_Text">plight1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> -11242;
            <span class="ActionScriptDefault_Text">plight1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ambient</span> <span class="ActionScriptOperator">=</span> 0.3;
            <span class="ActionScriptDefault_Text">plight1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ambientColor</span> <span class="ActionScriptOperator">=</span> 0x18235B;
            <span class="ActionScriptDefault_Text">plight1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">=</span> 0x2E71FF;
            <span class="ActionScriptDefault_Text">plight1</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">specular</span> <span class="ActionScriptOperator">=</span> 0.4;
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">scene</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">plight1</span><span class="ActionScriptBracket/Brace">)</span>;
             
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">plight2</span>:<span class="ActionScriptDefault_Text">PointLight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PointLight</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> -20250;
            <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> 4545;
            <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">diffuse</span> <span class="ActionScriptOperator">=</span> 0.1;
            <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> 500;
            <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ambient</span> <span class="ActionScriptOperator">=</span> 0.09;
            <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ambientColor</span> <span class="ActionScriptOperator">=</span> 0xC2CDFF;
            <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">radius</span> <span class="ActionScriptOperator">=</span> 1000;
            <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">=</span> 0xFFA825;
            <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fallOff</span> <span class="ActionScriptOperator">=</span> 6759;
            <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">specular</span> <span class="ActionScriptOperator">=</span> 0.1;
             <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">scene</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptBracket/Brace">)</span>;
         
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">plight3</span>:<span class="ActionScriptDefault_Text">PointLight</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">PointLight</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span> <span class="ActionScriptOperator">=</span> -7031;
            <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span> <span class="ActionScriptOperator">=</span> 2583;
            <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">diffuse</span> <span class="ActionScriptOperator">=</span> 1.3;
            <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span> <span class="ActionScriptOperator">=</span> -8319;
            <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ambient</span> <span class="ActionScriptOperator">=</span> 0.01;
            <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ambientColor</span> <span class="ActionScriptOperator">=</span> 0xFFFFFF;
            <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">radius</span> <span class="ActionScriptOperator">=</span> 1000;
            <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">=</span> 0xFF0500;
            <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fallOff</span> <span class="ActionScriptOperator">=</span> 6759;
            <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">specular</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">scene</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptBracket/Brace">)</span>;
             
            <span class="ActionScriptDefault_Text">_staticLightPicker</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">StaticLightPicker</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">plight1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">plight2</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">plight3</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * In this example the sprite sheets are genererated runtime, the data is stored into different movieclips in an swf file.
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setUpSpriteSheets</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">loader</span>:<span class="ActionScriptDefault_Text">Loader</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Loader</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contentLoaderInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">COMPLETE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">setUpAnimators</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">loadBytes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SourceSWF</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * Defining the spriteSheetAnimators and their data
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">setUpAnimators</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">loader</span>:<span class="ActionScriptDefault_Text">Loader</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Loader</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentTarget</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">loader</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">contentLoaderInfo</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">COMPLETE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">setUpAnimators</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sourceSwf</span>:<span class="ActionScriptDefault_Text">MovieClip</span> <span class="ActionScriptOperator">=</span>  <span class="ActionScriptDefault_Text">MovieClip</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentTarget</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">content</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">//in example swf, the source swf has a movieclip on stage named: "digits", it will be used for seconds, minutes and hours.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">animID</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"digits"</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">sourceMC</span>:<span class="ActionScriptDefault_Text">MovieClip</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceSwf</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">animID</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptComment">//the animation holds 60 frames, as we spread over 2 maps, we'll have 2 maps of 30 frames
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cols</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 6;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rows</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 5;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">spriteSheetHelper</span>:<span class="ActionScriptDefault_Text">SpriteSheetHelper</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetHelper</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//the spriteSheetHelper has a build method, that will return us one or more maps from our movieclips.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">diffuseSpriteSheets</span>:<span class="ActionScriptDefault_Text">Vector</span><span class="ActionScriptBracket/Brace">.&lt;</span><span class="ActionScriptDefault_Text">Texture2DBase</span><span class="ActionScriptBracket/Brace">&gt;</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">spriteSheetHelper</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generateFromMovieClip</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceMC</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cols</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rows</span><span class="ActionScriptOperator">,</span> 512<span class="ActionScriptOperator">,</span> 512<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">//We do not have yet geometry to apply on, but we can declare the materials.
</span>            <span class="ActionScriptComment">//As they need to be async from each other, we cannot share them in this clock case
</span>            <span class="ActionScriptDefault_Text">_hoursDigits</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">diffuseSpriteSheets</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_minutesDigits</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">diffuseSpriteSheets</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_secondsDigits</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">diffuseSpriteSheets</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">//we declare 3 different animators, as we will need to drive the time animations independantly. Reusing the same set.
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">digitsSet</span>:<span class="ActionScriptDefault_Text">SpriteSheetAnimationSet</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetAnimationSet</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">spriteSheetClipNode</span>:<span class="ActionScriptDefault_Text">SpriteSheetClipNode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">spriteSheetHelper</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generateSpriteSheetClipNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">animID</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cols</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rows</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> 60<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">digitsSet</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addAnimation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">spriteSheetClipNode</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">_hoursAnimator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetAnimator</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">digitsSet</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_minutesAnimator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetAnimator</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">digitsSet</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_secondsAnimator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetAnimator</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">digitsSet</span><span class="ActionScriptBracket/Brace">)</span>;
 
            <span class="ActionScriptComment">// the button on top of model gets a nice glowing and pulsing animation
</span>            <span class="ActionScriptDefault_Text">animID</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"pulse"</span>;
            <span class="ActionScriptComment">//the animation movieclip has 12 frames, we define the row and cols
</span>            <span class="ActionScriptDefault_Text">cols</span> <span class="ActionScriptOperator">=</span> 4;
            <span class="ActionScriptDefault_Text">rows</span> <span class="ActionScriptOperator">=</span> 3;
            <span class="ActionScriptDefault_Text">sourceMC</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceSwf</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">animID</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptDefault_Text">diffuseSpriteSheets</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">spriteSheetHelper</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generateFromMovieClip</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceMC</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cols</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rows</span><span class="ActionScriptOperator">,</span> 256<span class="ActionScriptOperator">,</span> 256<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pulseAnimationSet</span>:<span class="ActionScriptDefault_Text">SpriteSheetAnimationSet</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetAnimationSet</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">spriteSheetClipNode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">spriteSheetHelper</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generateSpriteSheetClipNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">animID</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cols</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rows</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> 12<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">pulseAnimationSet</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addAnimation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">spriteSheetClipNode</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_pulseAnimator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetAnimator</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pulseAnimationSet</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_pulseAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fps</span> <span class="ActionScriptOperator">=</span> 12;
            <span class="ActionScriptComment">// to make it interresting, it will loop back and fourth. So a full iteration will take 2 seconds
</span>            <span class="ActionScriptDefault_Text">_pulseAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">backAndForth</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
            <span class="ActionScriptDefault_Text">_pulseMaterial</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">diffuseSpriteSheets</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptComment">// the delimiter,
</span>            <span class="ActionScriptDefault_Text">animID</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"delimiter"</span>;
            <span class="ActionScriptComment">//the animation has 5 frames, it can fit on one row
</span>            <span class="ActionScriptDefault_Text">cols</span> <span class="ActionScriptOperator">=</span> 5;
            <span class="ActionScriptDefault_Text">rows</span> <span class="ActionScriptOperator">=</span> 2;
            <span class="ActionScriptDefault_Text">sourceMC</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">sourceSwf</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">animID</span><span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptDefault_Text">diffuseSpriteSheets</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">spriteSheetHelper</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generateFromMovieClip</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">sourceMC</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cols</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rows</span><span class="ActionScriptOperator">,</span> 256<span class="ActionScriptOperator">,</span> 256<span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">false</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">delimiterAnimationSet</span>:<span class="ActionScriptDefault_Text">SpriteSheetAnimationSet</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetAnimationSet</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">spriteSheetClipNode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">spriteSheetHelper</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">generateSpriteSheetClipNode</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">animID</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cols</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">rows</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">sourceMC</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">totalFrames</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">delimiterAnimationSet</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addAnimation</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">spriteSheetClipNode</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_delimiterAnimator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetAnimator</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">delimiterAnimationSet</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_delimiterAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fps</span> <span class="ActionScriptOperator">=</span> 6;
            <span class="ActionScriptDefault_Text">_delimiterMaterial</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">SpriteSheetMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">diffuseSpriteSheets</span><span class="ActionScriptBracket/Brace">)</span>;
 
            <span class="ActionScriptComment">//the required data is ready, time to load our model. We are now sure, all will be there when needed.
</span>            <span class="ActionScriptDefault_Text">loadModel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
         
         <span class="ActionScriptASDoc">/**
         * we can start load the model
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">loadModel</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//adding the awd 2.0 source file to the scene
</span>            <span class="ActionScriptDefault_Text">_loader</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Loader3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">Loader3D</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">enableParser</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">AWD2Parser</span><span class="ActionScriptBracket/Brace">)</span>;
 
            <span class="ActionScriptDefault_Text">_loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">AssetEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MESH_COMPLETE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onMeshReady</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LoaderEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RESOURCE_COMPLETE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onLoadedComplete</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LoaderEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LOAD_ERROR</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onLoadedError</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptComment">//the url must be relative to swf once published, change the url for your setup accordingly.
</span>            <span class="ActionScriptDefault_Text">_loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">load</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">URLRequest</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"assets/tictac/tictac.awd"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">AWD2Parser</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onLoadedError</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">LoaderEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScripttrace">trace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"0_o "</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">message</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * assigning the animators
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onMeshReady</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">AssetEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">asset</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">assetType</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">AssetType</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MESH</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">mesh</span>:<span class="ActionScriptDefault_Text">Mesh</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Mesh</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">asset</span><span class="ActionScriptBracket/Brace">)</span>;
 
                <span class="ActionScriptReserved">switch</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>

                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"hours"</span>:
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_hoursDigits</span>;
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">animator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_hoursAnimator</span>;
                        <span class="ActionScriptDefault_Text">_hoursAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">play</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"digits"</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">break</span>;

                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"minutes"</span>:
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_minutesDigits</span>;
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">animator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_minutesAnimator</span>;
                        <span class="ActionScriptDefault_Text">_minutesAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">play</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"digits"</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">break</span>;

                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"seconds"</span>:
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_secondsDigits</span>;
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">animator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_secondsAnimator</span>;
                        <span class="ActionScriptDefault_Text">_secondsAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">play</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"digits"</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">break</span>;

                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"delimiter"</span>:
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_delimiterMaterial</span>;
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">animator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_delimiterAnimator</span>;
                        <span class="ActionScriptDefault_Text">_delimiterAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">play</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"delimiter"</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">break</span>;

                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"button"</span>:
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_pulseMaterial</span>;
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">animator</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_pulseAnimator</span>;
                         <span class="ActionScriptDefault_Text">_pulseAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">play</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"pulse"</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptReserved">break</span>;
 

                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"furniture"</span>:
                        <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lightPicker</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_staticLightPicker</span>;
                        <span class="ActionScriptReserved">break</span>;

                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"frontscreen"</span>:
                        <span class="ActionScriptComment">//ignoring lightpicker on this mesh
</span>                        <span class="ActionScriptReserved">break</span>;

                    <span class="ActionScriptReserved">case</span> <span class="ActionScriptString">"chromebody"</span>:
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cubeTexture</span>:<span class="ActionScriptDefault_Text">BitmapCubeTexture</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">BitmapCubeTexture</span><span class="ActionScriptBracket/Brace">(</span>    <span class="ActionScriptDefault_Text">Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Back_CB0_Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bitmapData</span><span class="ActionScriptOperator">,</span>
                                                                        <span class="ActionScriptDefault_Text">Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Back_CB1_Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bitmapData</span><span class="ActionScriptOperator">,</span>
                                                                        <span class="ActionScriptDefault_Text">Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Back_CB2_Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bitmapData</span><span class="ActionScriptOperator">,</span>
                                                                        <span class="ActionScriptDefault_Text">Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Back_CB3_Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bitmapData</span><span class="ActionScriptOperator">,</span>
                                                                        <span class="ActionScriptDefault_Text">Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Back_CB4_Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bitmapData</span><span class="ActionScriptOperator">,</span>
                                                                        <span class="ActionScriptDefault_Text">Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Back_CB5_Bitmap</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">bitmapData</span><span class="ActionScriptBracket/Brace">)</span>;

                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">envMapMethod</span>:<span class="ActionScriptDefault_Text">EnvMapMethod</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">EnvMapMethod</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cubeTexture</span><span class="ActionScriptOperator">,</span> 0.1<span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">SinglePassMaterialBase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addMethod</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">envMapMethod</span><span class="ActionScriptBracket/Brace">)</span>;

                    <span class="ActionScriptReserved">default</span>:
                        <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lightPicker</span><span class="ActionScriptBracket/Brace">)</span>
                            <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lightPicker</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_staticLightPicker</span>;

                <span class="ActionScriptBracket/Brace">}</span>

                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fogMethod</span>:<span class="ActionScriptDefault_Text">FogMethod</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">FogMethod</span><span class="ActionScriptBracket/Brace">(</span>20000<span class="ActionScriptOperator">,</span> 50000<span class="ActionScriptOperator">,</span> 0x10C14<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">SinglePassMaterialBase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addMethod</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">fogMethod</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">clearListeners</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">_loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">AssetEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MESH_COMPLETE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onMeshReady</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LoaderEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">RESOURCE_COMPLETE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onLoadedComplete</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">removeEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">LoaderEvent</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">LOAD_ERROR</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">onLoadedError</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * the model is loaded. Time to display our work
         */</span>

        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onLoadedComplete</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">LoaderEvent</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
             <span class="ActionScriptDefault_Text">clearListeners</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
             <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">scene</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addChild</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">ObjectContainer3D</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">currentTarget</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ENTER_FRAME</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">_onEnterFrame</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">startTween</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>


        <span class="ActionScriptASDoc">/**
         * updating the digit according to current time
         */</span>
          <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">updateClock</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">date</span>:<span class="ActionScriptDefault_Text">Date</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Date</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_lastHour</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">date</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hours</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_lastHour</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">date</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hours</span><span class="ActionScriptOperator">+</span>1;
                <span class="ActionScriptDefault_Text">_hoursAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">gotoAndStop</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_lastHour</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_lastMinute</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">date</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">minutes</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_lastMinute</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">date</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">minutes</span><span class="ActionScriptOperator">+</span>1;
                <span class="ActionScriptDefault_Text">_minutesAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">gotoAndStop</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_lastMinute</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_lastSecond</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptDefault_Text">date</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">seconds</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">_lastSecond</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">date</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">seconds</span><span class="ActionScriptOperator">+</span>1;
                <span class="ActionScriptDefault_Text">_secondsAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">gotoAndStop</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_lastSecond</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">_delimiterAnimator</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">gotoAndPlay</span><span class="ActionScriptBracket/Brace">(</span>1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptASDoc">/**
         * endless tween to add some dramatic!
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">startTween</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">destX</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptOperator">-</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">random</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>24000<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span>4000;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">destY</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">random</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>16000;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">destZ</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> 3000<span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">random</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>18000;

            <span class="ActionScriptDefault_Text">Tweener</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addTween</span><span class="ActionScriptBracket/Brace">(</span>    <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">camera</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">{</span><span class="ActionScriptDefault_Text">x</span>:<span class="ActionScriptDefault_Text">destX</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">y</span>:<span class="ActionScriptDefault_Text">destY</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">z</span>:<span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">destZ</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">time</span>:4<span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">random</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">*</span>2<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> 
                            <span class="ActionScriptDefault_Text">transition</span>:<span class="ActionScriptString">"easeInOutQuad"</span><span class="ActionScriptOperator">,</span>
                            <span class="ActionScriptDefault_Text">onComplete</span>:<span class="ActionScriptDefault_Text">startTween</span> <span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * render loop
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">_onEnterFrame</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>    
            <span class="ActionScriptDefault_Text">updateClock</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">camera</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lookAt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_origin</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">render</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * stage listener for resize events
         */</span>
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">onResize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">event</span>:<span class="ActionScriptDefault_Text">Event</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">width</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">stage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stageWidth</span>;
            <span class="ActionScriptDefault_Text">_view</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">height</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">stage</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">stageHeight</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
